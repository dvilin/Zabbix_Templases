<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>6.0</version>
    <date>2022-02-21T08:19:20Z</date>
    <groups>
        <group>
            <uuid>baa335c9b0cc453a9d60c387d7e2d03d</uuid>
            <name>Group Windows Host</name>
        </group>
    </groups>
    <templates>
        <template>
            <uuid>13b06904a6bf41cbb795e3193d896340</uuid>
            <template>Rus Win Zb agent</template>
            <name>Rus Win Zb agent</name>
            <description>Перевод стандартного шаблона на русский 

-Петька, ПРИБОРЫ!
-Пятьсот восемьдесят шесть!
-Чего, &quot;пятьсот восемьдесят шесть&quot;?
-А чего &quot;ПРИБОРЫ&quot;?

Official Windows template. Requires agent of Zabbix 4.4 and newer.


You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback/387224-discussion-thread-for-official-zabbix-template-for-windows

Template tooling version used: 0.41</description>
            <groups>
                <group>
                    <name>Group Windows Host</name>
                </group>
            </groups>
            <items>
                <item>
                    <uuid>af550a1bfe74428eb24492d8af3b405e</uuid>
                    <name>Host name of Zabbix agent running</name>
                    <key>agent.hostname</key>
                    <delay>1h</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>1d</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>system</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>f81e2ce0d1104f9aaf1fc49284ed0ed4</uuid>
                    <name>Zabbix agent ping</name>
                    <key>agent.ping</key>
                    <history>7d</history>
                    <description>The agent always returns 1 for this item. It could be used in combination with nodata() for availability check.</description>
                    <valuemap>
                        <name>Zabbix agent ping status</name>
                    </valuemap>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>system</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>5707443d739d4689bde192e75ff4bd0f</uuid>
                    <name>Version of Zabbix agent running</name>
                    <key>agent.version</key>
                    <delay>1h</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>1d</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>application</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>5219a246de0641a89685a961cdd08c0b</uuid>
                    <name>Cache bytes</name>
                    <key>perf_counter_en[&quot;\Memory\Cache Bytes&quot;]</key>
                    <history>7d</history>
                    <units>B</units>
                    <description>Cache Bytes is the sum of the Memory\\System Cache Resident Bytes, Memory\\System Driver Resident Bytes,
Memory\\System Code Resident Bytes, and Memory\\Pool Paged Resident Bytes counters. This counter displays
the last observed value only; it is not an average.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>memory</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>2ea74fafb9334de095adcb47cced578d</uuid>
                    <name>Free system page table entries</name>
                    <key>perf_counter_en[&quot;\Memory\Free System Page Table Entries&quot;]</key>
                    <history>7d</history>
                    <description>This indicates the number of page table entries not currently in use by the system. If the number is less
than 5,000, there may well be a memory leak or you running out of memory.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>memory</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>e3118e2e6109460f80cc2d56795ed42f</uuid>
                            <expression>max(/Rus Win Zb agent/perf_counter_en[&quot;\Memory\Free System Page Table Entries&quot;],5m)&lt;{$MEM.PAGE_TABLE_CRIT.MIN}</expression>
                            <name>Количество свободных записей в таблице системных страниц слишком мало (менее {$MEM.PAGE_TABLE_CRIT.MIN} в течении 5m)</name>
                            <priority>WARNING</priority>
                            <description>The Memory Free System Page Table Entries is less than {$MEM.PAGE_TABLE_CRIT.MIN} for 5 minutes. If the number is less than 5,000, there may well be a memory leak.</description>
                            <dependencies>
                                <dependency>
                                    <name>Высокая загрузка памяти (&gt;{$MEMORY.UTIL.MAX}% в течении 5m)</name>
                                    <expression>min(/Rus Win Zb agent/vm.memory.util,5m)&gt;{$MEMORY.UTIL.MAX}</expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>scope</tag>
                                    <value>capacity</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>6c41d254585a4d7b81a0c5766a8913c1</uuid>
                    <name>Memory page faults per second</name>
                    <key>perf_counter_en[&quot;\Memory\Page Faults/sec&quot;]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <description>Page Faults/sec is the average number of pages faulted per second. It is measured in number of pages
faulted per second because only one page is faulted in each fault operation, hence this is also equal
to the number of page fault operations. This counter includes both hard faults (those that require
disk access) and soft faults (where the faulted page is found elsewhere in physical memory.) Most
processors can handle large numbers of soft faults without significant consequence. However, hard faults,
which require disk access, can cause significant delays.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>memory</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>287163bc5b0441c4bf51489432a278eb</uuid>
                    <name>Memory pages per second</name>
                    <key>perf_counter_en[&quot;\Memory\Pages/sec&quot;]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <description>This measures the rate at which pages are read from or written to disk to resolve hard page faults.
If the value is greater than 1,000, as a result of excessive paging, there may be a memory leak.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>memory</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>ab4c9a66d16f42e6a32f6144f4d2a3ca</uuid>
                            <expression>min(/Rus Win Zb agent/perf_counter_en[&quot;\Memory\Pages/sec&quot;],5m)&gt;{$MEM.PAGE_SEC.CRIT.MAX}</expression>
                            <name>Память\Обмен страниц в сек слишком высок (более{$MEM.PAGE_SEC.CRIT.MAX} for 5m)</name>
                            <priority>WARNING</priority>
                            <description>The Memory Pages/sec in the last 5 minutes exceeds {$MEM.PAGE_SEC.CRIT.MAX}. If the value is greater than 1,000, as a result of excessive paging, there may be a memory leak.</description>
                            <dependencies>
                                <dependency>
                                    <name>Высокая загрузка памяти (&gt;{$MEMORY.UTIL.MAX}% в течении 5m)</name>
                                    <expression>min(/Rus Win Zb agent/vm.memory.util,5m)&gt;{$MEMORY.UTIL.MAX}</expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>scope</tag>
                                    <value>capacity</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>fb822cb2a17948208a61bd6661c496df</uuid>
                    <name>Memory pool non-paged</name>
                    <key>perf_counter_en[&quot;\Memory\Pool Nonpaged Bytes&quot;]</key>
                    <history>7d</history>
                    <units>B</units>
                    <description>This measures the size, in bytes, of the non-paged pool. This is an area of system memory for objects
that cannot be written to disk but instead must remain in physical memory as long as they are allocated.
There is a possible memory leak if the value is greater than 175MB (or 100MB with the /3GB switch).
A typical Event ID 2019 is recorded in the system event log.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>memory</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>b99a722d267d455fad3c07c53302b20f</uuid>
                    <name>Used swap space in %</name>
                    <key>perf_counter_en[&quot;\Paging file(_Total)\% Usage&quot;]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>The used space of swap volume/file in percent.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>memory</value>
                        </tag>
                        <tag>
                            <tag>component</tag>
                            <value>storage</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>ee1f116fdab34969a6e6f5e1c25fc3d2</uuid>
                    <name>CPU DPC time</name>
                    <key>perf_counter_en[&quot;\Processor Information(_total)\% DPC Time&quot;]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>Processor DPC time is the time that a single processor spent receiving and servicing deferred procedure
calls (DPCs). DPCs are interrupts that run at a lower priority than standard interrupts. % DPC Time is a
component of % Privileged Time because DPCs are executed in privileged mode. If a high % DPC Time is
sustained, there may be a processor bottleneck or an application or hardware related issue that can
significantly diminish overall system performance.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>cpu</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>e403552481b04ebdba2e8a019f114f20</uuid>
                    <name>CPU interrupt time</name>
                    <key>perf_counter_en[&quot;\Processor Information(_total)\% Interrupt Time&quot;]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>The Processor Information\% Interrupt Time is the time the processor spends receiving and servicing
hardware interrupts during sample intervals. This value is an indirect indicator of the activity of
devices that generate interrupts, such as the system clock, the mouse, disk drivers, data communication
lines, network interface cards and other peripheral devices. This is an easy way to identify a potential
hardware failure. This should never be higher than 20%.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>cpu</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>f67bedcb282349b2aac052baf4963480</uuid>
                            <expression>min(/Rus Win Zb agent/perf_counter_en[&quot;\Processor Information(_total)\% Interrupt Time&quot;],5m)&gt;{$CPU.INTERRUPT.CRIT.MAX}</expression>
                            <name>Время прерывания ЦП слишком велико (over {$CPU.INTERRUPT.CRIT.MAX}% for 5m)</name>
                            <priority>WARNING</priority>
                            <description>&quot;The CPU Interrupt Time in the last 5 minutes exceeds {$CPU.INTERRUPT.CRIT.MAX}%.&quot;
The Processor Information\% Interrupt Time is the time the processor spends receiving and servicing
hardware interrupts during sample intervals. This value is an indirect indicator of the activity of
devices that generate interrupts, such as the system clock, the mouse, disk drivers, data communication
lines, network interface cards and other peripheral devices. This is an easy way to identify a potential
hardware failure. This should never be higher than 20%.</description>
                            <dependencies>
                                <dependency>
                                    <name>Высокая загрузка ЦП (over {$CPU.UTIL.CRIT}% в течение 5m)</name>
                                    <expression>min(/Rus Win Zb agent/system.cpu.util,5m)&gt;{$CPU.UTIL.CRIT}</expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>scope</tag>
                                    <value>performance</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>37448f05afe340a3891d05528c9d1adc</uuid>
                    <name>CPU privileged time</name>
                    <key>perf_counter_en[&quot;\Processor Information(_total)\% Privileged Time&quot;]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>The Processor Information\% Privileged Time counter shows the percent of time that the processor is spent
executing in Kernel (or Privileged) mode. Privileged mode includes services interrupts inside Interrupt
Service Routines (ISRs), executing Deferred Procedure Calls (DPCs), Device Driver calls and other kernel-mode
functions of the Windows® Operating System.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>cpu</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>4d099256b3ba42f1b90143e2014900dd</uuid>
                            <expression>min(/Rus Win Zb agent/perf_counter_en[&quot;\Processor Information(_total)\% Privileged Time&quot;],5m)&gt;{$CPU.PRIV.CRIT.MAX}</expression>
                            <name>Привилегированное время ЦП слишком велико (over {$CPU.PRIV.CRIT.MAX}% в течение 5m)</name>
                            <priority>WARNING</priority>
                            <description>The CPU privileged time in the last 5 minutes exceeds {$CPU.PRIV.CRIT.MAX}%.</description>
                            <dependencies>
                                <dependency>
                                    <name>Время прерывания ЦП слишком велико (over {$CPU.INTERRUPT.CRIT.MAX}% for 5m)</name>
                                    <expression>min(/Rus Win Zb agent/perf_counter_en[&quot;\Processor Information(_total)\% Interrupt Time&quot;],5m)&gt;{$CPU.INTERRUPT.CRIT.MAX}</expression>
                                </dependency>
                                <dependency>
                                    <name>Высокая загрузка ЦП (over {$CPU.UTIL.CRIT}% в течение 5m)</name>
                                    <expression>min(/Rus Win Zb agent/system.cpu.util,5m)&gt;{$CPU.UTIL.CRIT}</expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>scope</tag>
                                    <value>performance</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>575912d512624143b564ca0fbfd0bb8f</uuid>
                    <name>CPU user time</name>
                    <key>perf_counter_en[&quot;\Processor Information(_total)\% User Time&quot;]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>The Processor Information\% User Time counter shows the percent of time that the processor(s) is spent executing
in User mode.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>cpu</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>2322a85bfc1049a3b5c892d83b5d5054</uuid>
                    <name>Context switches per second</name>
                    <key>perf_counter_en[&quot;\System\Context Switches/sec&quot;]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <description>Context Switches/sec is the combined rate at which all processors on the computer are switched from one thread to another.
Context switches occur when a running thread voluntarily relinquishes the processor, is preempted by a higher priority ready thread, or switches between user-mode and privileged (kernel) mode to use an Executive or subsystem service.
It is the sum of Thread\\Context Switches/sec for all threads running on all processors in the computer and is measured in numbers of switches.
There are context switch counters on the System and Thread objects. This counter displays the difference between the values observed in the last two samples, divided by the duration of the sample interval.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>cpu</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>002af28df72f4a788c88bc022d88c6dd</uuid>
                    <name>CPU queue length</name>
                    <key>perf_counter_en[&quot;\System\Processor Queue Length&quot;]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <description>The Processor Queue Length shows the number of threads that are observed as delayed in the processor Ready Queue
and are waiting to be executed.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>cpu</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>630b7b2af6274936ab80b1dd774113e5</uuid>
                    <name>Number of threads</name>
                    <key>perf_counter_en[&quot;\System\Threads&quot;]</key>
                    <history>7d</history>
                    <description>The number of threads used by all running processes.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>os</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>b305029532f84daf93c8da2d181ac3a1</uuid>
                    <name>Number of processes</name>
                    <key>proc.num[]</key>
                    <history>7d</history>
                    <description>The number of processes.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>os</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>c2ed8e2efab04564b6c70ee8ad14730f</uuid>
                    <name>CPU utilization</name>
                    <key>system.cpu.util</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>CPU utilization in %</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>cpu</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>806aa232f56640ab98aacc79491fc4d7</uuid>
                            <expression>min(/Rus Win Zb agent/system.cpu.util,5m)&gt;{$CPU.UTIL.CRIT}</expression>
                            <name>Высокая загрузка ЦП (over {$CPU.UTIL.CRIT}% в течение 5m)</name>
                            <opdata>Current utilization: {ITEM.LASTVALUE1}</opdata>
                            <priority>WARNING</priority>
                            <description>CPU utilization is too high. The system might be slow to respond.</description>
                            <tags>
                                <tag>
                                    <tag>scope</tag>
                                    <value>performance</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>cb056886ce72426e833a0445f9263906</uuid>
                    <name>System name</name>
                    <key>system.hostname</key>
                    <delay>1h</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>System host name.</description>
                    <inventory_link>NAME</inventory_link>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>1d</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>system</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>6b50d36a4e29468a9546e880f3004399</uuid>
                            <expression>last(/Rus Win Zb agent/system.hostname,#1)&lt;&gt;last(/Rus Win Zb agent/system.hostname,#2) and length(last(/Rus Win Zb agent/system.hostname))&gt;0</expression>
                            <name>Имя системы изменилось (новое имя: {ITEM.VALUE})</name>
                            <priority>INFO</priority>
                            <description>System name has changed. Ack to close.</description>
                            <manual_close>YES</manual_close>
                            <tags>
                                <tag>
                                    <tag>scope</tag>
                                    <value>notice</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>94c4dfe23e2e4c6e995a3a715941a8eb</uuid>
                    <name>System local time</name>
                    <key>system.localtime</key>
                    <history>7d</history>
                    <units>unixtime</units>
                    <description>System local time of the host.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>system</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>37ca2366c8474cc8a49a605e93377601</uuid>
                            <expression>fuzzytime(/Rus Win Zb agent/system.localtime,{$SYSTEM.FUZZYTIME.MAX})=0</expression>
                            <name>Системное время не синхронизировано (разница с сервером Zabbix &gt; {$SYSTEM.FUZZYTIME.MAX}s)</name>
                            <priority>WARNING</priority>
                            <description>The host system time is different from the Zabbix server time.</description>
                            <manual_close>YES</manual_close>
                            <tags>
                                <tag>
                                    <tag>scope</tag>
                                    <value>notice</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>7e8b3476db6d4322a10cd1a28cbdb7ea</uuid>
                    <name>Operating system architecture</name>
                    <key>system.sw.arch</key>
                    <delay>1h</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>Operating system architecture of the host.</description>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>1d</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>os</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>11cac38334544e5cbb028cfd473cb39e</uuid>
                    <name>Free swap space</name>
                    <type>CALCULATED</type>
                    <key>system.swap.free</key>
                    <history>7d</history>
                    <units>B</units>
                    <params>last(//system.swap.size[,total]) - last(//system.swap.size[,total]) / 100 * last(//perf_counter_en[&quot;\Paging file(_Total)\% Usage&quot;])</params>
                    <description>The free space of swap volume/file in bytes.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>memory</value>
                        </tag>
                        <tag>
                            <tag>component</tag>
                            <value>storage</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>9c7e3c843a3045df81dddc5d18de267c</uuid>
                    <name>Free swap space in %</name>
                    <type>DEPENDENT</type>
                    <key>system.swap.pfree</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>The free space of swap volume/file in percent.</description>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>return (100 - value)</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>perf_counter_en[&quot;\Paging file(_Total)\% Usage&quot;]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>memory</value>
                        </tag>
                        <tag>
                            <tag>component</tag>
                            <value>storage</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>f981835baf04494eaff2f33f159e0ab5</uuid>
                    <name>Total swap space</name>
                    <key>system.swap.size[,total]</key>
                    <history>7d</history>
                    <units>B</units>
                    <description>The total space of swap volume/file in bytes.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>memory</value>
                        </tag>
                        <tag>
                            <tag>component</tag>
                            <value>storage</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>b103a2c22fe344f886e9dc9f4e4a65ec</uuid>
                    <name>System description</name>
                    <key>system.uname</key>
                    <delay>15m</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>System description of the host.</description>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>1d</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>system</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>12503fbf4400488e9b5ff0488f164cb6</uuid>
                    <name>Uptime</name>
                    <key>system.uptime</key>
                    <delay>30s</delay>
                    <history>2w</history>
                    <trends>0d</trends>
                    <units>uptime</units>
                    <description>System uptime in 'N days, hh:mm:ss' format.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>system</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>d27b9eab4034439f91dff41fe6f043ab</uuid>
                            <expression>last(/Rus Win Zb agent/system.uptime)&lt;10m</expression>
                            <name>Хост был перезапущен в течении 10m</name>
                            <priority>WARNING</priority>
                            <description>The device uptime is less than 10 minutes.</description>
                            <manual_close>YES</manual_close>
                            <tags>
                                <tag>
                                    <tag>scope</tag>
                                    <value>notice</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>09e9a345a0f445b1a65685911f5eb9b0</uuid>
                    <name>Total memory</name>
                    <key>vm.memory.size[total]</key>
                    <history>7d</history>
                    <units>B</units>
                    <description>Total memory in Bytes</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>memory</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>1cbf45e11dab453797fe291639aa0c01</uuid>
                    <name>Used memory</name>
                    <key>vm.memory.size[used]</key>
                    <history>7d</history>
                    <units>B</units>
                    <description>Used memory in Bytes</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>memory</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>3b1e4ecaa04a46e9b0aee956918f0713</uuid>
                    <name>Memory utilization</name>
                    <type>CALCULATED</type>
                    <key>vm.memory.util</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <params>last(//vm.memory.size[used]) / last(//vm.memory.size[total]) * 100</params>
                    <description>Memory utilization in %</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>memory</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>b442993bb2a6404a8ebcb7be39d16ce6</uuid>
                            <expression>min(/Rus Win Zb agent/vm.memory.util,5m)&gt;{$MEMORY.UTIL.MAX}</expression>
                            <name>Высокая загрузка памяти (&gt;{$MEMORY.UTIL.MAX}% в течении 5m)</name>
                            <priority>AVERAGE</priority>
                            <description>The system is running out of free memory.</description>
                            <tags>
                                <tag>
                                    <tag>scope</tag>
                                    <value>capacity</value>
                                </tag>
                                <tag>
                                    <tag>scope</tag>
                                    <value>performance</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>08b70a5b80fd435ba393e3deb3ca5adb</uuid>
                    <name>Network interfaces WMI get</name>
                    <key>wmi.getall[root\cimv2,&quot;select Name,Description,NetConnectionID,Speed,AdapterTypeId,NetConnectionStatus,GUID from win32_networkadapter where PhysicalAdapter=True and NetConnectionStatus&gt;0&quot;]</key>
                    <history>0</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>Raw data of win32_networkadapter.</description>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>1h</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>raw</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>83c8c6f15b524a2fb04fc90d04d3e8a2</uuid>
                    <name>Number of cores</name>
                    <key>wmi.get[root/cimv2,&quot;Select NumberOfLogicalProcessors from Win32_ComputerSystem&quot;]</key>
                    <history>7d</history>
                    <description>The number of logical processors available on the computer.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>cpu</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>3dcb0f79342b4ded97cdec0794472266</uuid>
                    <name>Zabbix agent availability</name>
                    <type>INTERNAL</type>
                    <key>zabbix[host,agent,available]</key>
                    <history>7d</history>
                    <description>Monitoring agent availability status</description>
                    <valuemap>
                        <name>zabbix.host.available</name>
                    </valuemap>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>system</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>05beb4500cae480892fad0739f99807d</uuid>
                            <expression>max(/Rus Win Zb agent/zabbix[host,agent,available],{$AGENT.TIMEOUT})=0</expression>
                            <name>Агент Zabbix недоступен (в течение {$AGENT.TIMEOUT})</name>
                            <priority>AVERAGE</priority>
                            <description>For passive only agents, host availability is used with {$AGENT.TIMEOUT} as time threshold.</description>
                            <manual_close>YES</manual_close>
                            <tags>
                                <tag>
                                    <tag>scope</tag>
                                    <value>availability</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <uuid>ba19d6566fdb4a668d4363769d1fee01</uuid>
                    <name>Network interfaces discovery</name>
                    <type>DEPENDENT</type>
                    <key>net.if.discovery</key>
                    <delay>0</delay>
                    <filter>
                        <evaltype>AND</evaltype>
                        <conditions>
                            <condition>
                                <macro>{#IFNAME}</macro>
                                <value>{$NET.IF.IFNAME.MATCHES}</value>
                                <formulaid>E</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFNAME}</macro>
                                <value>{$NET.IF.IFNAME.NOT_MATCHES}</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>F</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFDESCR}</macro>
                                <value>{$NET.IF.IFDESCR.MATCHES}</value>
                                <formulaid>C</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFDESCR}</macro>
                                <value>{$NET.IF.IFDESCR.NOT_MATCHES}</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>D</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFALIAS}</macro>
                                <value>{$NET.IF.IFALIAS.MATCHES}</value>
                                <formulaid>A</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFALIAS}</macro>
                                <value>{$NET.IF.IFALIAS.NOT_MATCHES}</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>B</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <description>Discovery of installed network interfaces.</description>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>8a7bb1e8afd24d32a65fa2116ba439ce</uuid>
                            <name>Interface {#IFNAME}({#IFALIAS}): Inbound packets discarded</name>
                            <key>net.if.in[&quot;{#IFGUID}&quot;,dropped]</key>
                            <delay>3m</delay>
                            <history>7d</history>
                            <description>The number of incoming packets dropped on the network interface.</description>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <parameters>
                                        <parameter/>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>network</value>
                                </tag>
                                <tag>
                                    <tag>description</tag>
                                    <value>{#IFALIAS}</value>
                                </tag>
                                <tag>
                                    <tag>interface</tag>
                                    <value>{#IFNAME}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>6e1f3dfb91024095a20870ee94d01822</uuid>
                            <name>Interface {#IFNAME}({#IFALIAS}): Inbound packets with errors</name>
                            <key>net.if.in[&quot;{#IFGUID}&quot;,errors]</key>
                            <delay>3m</delay>
                            <history>7d</history>
                            <description>The number of incoming packets with errors on the network interface.</description>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <parameters>
                                        <parameter/>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>network</value>
                                </tag>
                                <tag>
                                    <tag>description</tag>
                                    <value>{#IFALIAS}</value>
                                </tag>
                                <tag>
                                    <tag>interface</tag>
                                    <value>{#IFNAME}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>82accc942f5747a2b399484466625051</uuid>
                            <name>Interface {#IFNAME}({#IFALIAS}): Bits received</name>
                            <key>net.if.in[&quot;{#IFGUID}&quot;]</key>
                            <delay>3m</delay>
                            <history>7d</history>
                            <units>bps</units>
                            <description>Incoming traffic on the network interface.</description>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <parameters>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <parameters>
                                        <parameter>8</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>network</value>
                                </tag>
                                <tag>
                                    <tag>description</tag>
                                    <value>{#IFALIAS}</value>
                                </tag>
                                <tag>
                                    <tag>interface</tag>
                                    <value>{#IFNAME}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>9ddb9aaf863a45c0affbd90e4a6fa393</uuid>
                            <name>Interface {#IFNAME}({#IFALIAS}): Outbound packets discarded</name>
                            <key>net.if.out[&quot;{#IFGUID}&quot;,dropped]</key>
                            <delay>3m</delay>
                            <history>7d</history>
                            <description>The number of outgoing packets dropped on the network interface.</description>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <parameters>
                                        <parameter/>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>network</value>
                                </tag>
                                <tag>
                                    <tag>description</tag>
                                    <value>{#IFALIAS}</value>
                                </tag>
                                <tag>
                                    <tag>interface</tag>
                                    <value>{#IFNAME}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>38c8a1aa95b343e39e23e7b508521dad</uuid>
                            <name>Interface {#IFNAME}({#IFALIAS}): Outbound packets with errors</name>
                            <key>net.if.out[&quot;{#IFGUID}&quot;,errors]</key>
                            <delay>3m</delay>
                            <history>7d</history>
                            <description>The number of outgoing packets with errors on the network interface.</description>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <parameters>
                                        <parameter/>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>network</value>
                                </tag>
                                <tag>
                                    <tag>description</tag>
                                    <value>{#IFALIAS}</value>
                                </tag>
                                <tag>
                                    <tag>interface</tag>
                                    <value>{#IFNAME}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>3b090da19af842189bb6fa56d49ceec3</uuid>
                            <name>Interface {#IFNAME}({#IFALIAS}): Bits sent</name>
                            <key>net.if.out[&quot;{#IFGUID}&quot;]</key>
                            <delay>3m</delay>
                            <history>7d</history>
                            <units>bps</units>
                            <description>Outgoing traffic on the network interface.</description>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <parameters>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <parameters>
                                        <parameter>8</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>network</value>
                                </tag>
                                <tag>
                                    <tag>description</tag>
                                    <value>{#IFALIAS}</value>
                                </tag>
                                <tag>
                                    <tag>interface</tag>
                                    <value>{#IFNAME}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>0445b842d1ce4c7f9fd5716c78a079c4</uuid>
                            <name>Interface {#IFNAME}({#IFALIAS}): Speed</name>
                            <type>DEPENDENT</type>
                            <key>net.if.speed[&quot;{#IFGUID}&quot;]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0d</trends>
                            <units>bps</units>
                            <description>Estimated bandwidth of the network interface if any.</description>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$[?(@.GUID == &quot;{#IFGUID}&quot;)].Speed.first()</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_VALUE</error_handler>
                                    <error_handler_params>0</error_handler_params>
                                </step>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>return (value=='9223372036854775807' ? 0 : value)</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>wmi.getall[root\cimv2,&quot;select Name,Description,NetConnectionID,Speed,AdapterTypeId,NetConnectionStatus,GUID from win32_networkadapter where PhysicalAdapter=True and NetConnectionStatus&gt;0&quot;]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>network</value>
                                </tag>
                                <tag>
                                    <tag>description</tag>
                                    <value>{#IFALIAS}</value>
                                </tag>
                                <tag>
                                    <tag>interface</tag>
                                    <value>{#IFNAME}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>c495bffb7e244e5caf5dc013d839b758</uuid>
                            <name>Interface {#IFNAME}({#IFALIAS}): Operational status</name>
                            <type>DEPENDENT</type>
                            <key>net.if.status[&quot;{#IFGUID}&quot;]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <description>The operational status of the network interface.</description>
                            <valuemap>
                                <name>Win32_NetworkAdapter::NetConnectionStatus</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$[?(@.GUID == &quot;{#IFGUID}&quot;)].NetConnectionStatus.first()</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1d</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>wmi.getall[root\cimv2,&quot;select Name,Description,NetConnectionID,Speed,AdapterTypeId,NetConnectionStatus,GUID from win32_networkadapter where PhysicalAdapter=True and NetConnectionStatus&gt;0&quot;]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>network</value>
                                </tag>
                                <tag>
                                    <tag>description</tag>
                                    <value>{#IFALIAS}</value>
                                </tag>
                                <tag>
                                    <tag>interface</tag>
                                    <value>{#IFNAME}</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>a9b1c61ac4a6481aab93d40c6fb93462</uuid>
                                    <expression>{$IFCONTROL:&quot;{#IFNAME}&quot;}=1 and last(/Rus Win Zb agent/net.if.status[&quot;{#IFGUID}&quot;])&lt;&gt;2 and (last(/Rus Win Zb agent/net.if.status[&quot;{#IFGUID}&quot;],#1)&lt;&gt;last(/Rus Win Zb agent/net.if.status[&quot;{#IFGUID}&quot;],#2))</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>last(/Rus Win Zb agent/net.if.status[&quot;{#IFGUID}&quot;])=2 or {$IFCONTROL:&quot;{#IFNAME}&quot;}=0</recovery_expression>
                                    <name>Interface {#IFNAME}({#IFALIAS}): Link down</name>
                                    <opdata>Current state: {ITEM.LASTVALUE1}</opdata>
                                    <priority>AVERAGE</priority>
                                    <description>This trigger expression works as follows:
1. Can be triggered if operations status is down.
2. {$IFCONTROL:\&quot;{#IFNAME}\&quot;}=1 - user can redefine Context macro to value - 0. That marks this interface as not important.
    No new trigger will be fired if this interface is down.
3. {TEMPLATE_NAME:METRIC.diff()}=1) - trigger fires only if operational status is different from Connected(2).

WARNING: if closed manually - won't fire again on next poll, because of .diff.</description>
                                    <manual_close>YES</manual_close>
                                    <tags>
                                        <tag>
                                            <tag>scope</tag>
                                            <value>availability</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>11ce3d38745a49f58f713fcef1a913c5</uuid>
                            <name>Interface {#IFNAME}({#IFALIAS}): Interface type</name>
                            <type>DEPENDENT</type>
                            <key>net.if.type[&quot;{#IFGUID}&quot;]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0d</trends>
                            <description>The type of the network interface.</description>
                            <valuemap>
                                <name>Win32_NetworkAdapter::AdapterTypeId</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$[?(@.GUID == &quot;{#IFGUID}&quot;)].AdapterTypeId.first()</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1d</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>wmi.getall[root\cimv2,&quot;select Name,Description,NetConnectionID,Speed,AdapterTypeId,NetConnectionStatus,GUID from win32_networkadapter where PhysicalAdapter=True and NetConnectionStatus&gt;0&quot;]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>network</value>
                                </tag>
                                <tag>
                                    <tag>description</tag>
                                    <value>{#IFALIAS}</value>
                                </tag>
                                <tag>
                                    <tag>interface</tag>
                                    <value>{#IFNAME}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <uuid>b2191521a7a54985a19740e3ee2674f2</uuid>
                            <expression>change(/Rus Win Zb agent/net.if.speed[&quot;{#IFGUID}&quot;])&lt;0 and
last(/Rus Win Zb agent/net.if.speed[&quot;{#IFGUID}&quot;])&gt;0 and
last(/Rus Win Zb agent/net.if.status[&quot;{#IFGUID}&quot;])=2</expression>
                            <name>Interface {#IFNAME}({#IFALIAS}): Ethernet has changed to lower speed than it was before</name>
                            <opdata>Current reported speed: {ITEM.LASTVALUE1}</opdata>
                            <priority>INFO</priority>
                            <description>This Ethernet connection has transitioned down from its known maximum speed. This might be a sign of autonegotiation issues. Ack to close.</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Interface {#IFNAME}({#IFALIAS}): Link down</name>
                                    <expression>{$IFCONTROL:&quot;{#IFNAME}&quot;}=1 and last(/Rus Win Zb agent/net.if.status[&quot;{#IFGUID}&quot;])&lt;&gt;2 and (last(/Rus Win Zb agent/net.if.status[&quot;{#IFGUID}&quot;],#1)&lt;&gt;last(/Rus Win Zb agent/net.if.status[&quot;{#IFGUID}&quot;],#2))</expression>
                                    <recovery_expression>last(/Rus Win Zb agent/net.if.status[&quot;{#IFGUID}&quot;])=2 or {$IFCONTROL:&quot;{#IFNAME}&quot;}=0</recovery_expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>scope</tag>
                                    <value>capacity</value>
                                </tag>
                            </tags>
                        </trigger_prototype>
                        <trigger_prototype>
                            <uuid>c93048183c3942808c60d6dd61963bc0</uuid>
                            <expression>(avg(/Rus Win Zb agent/net.if.in[&quot;{#IFGUID}&quot;],15m)&gt;({$IF.UTIL.MAX:&quot;{#IFNAME}&quot;}/100)*last(/Rus Win Zb agent/net.if.speed[&quot;{#IFGUID}&quot;]) or
avg(/Rus Win Zb agent/net.if.out[&quot;{#IFGUID}&quot;],15m)&gt;({$IF.UTIL.MAX:&quot;{#IFNAME}&quot;}/100)*last(/Rus Win Zb agent/net.if.speed[&quot;{#IFGUID}&quot;])) and
last(/Rus Win Zb agent/net.if.speed[&quot;{#IFGUID}&quot;])&gt;0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>avg(/Rus Win Zb agent/net.if.in[&quot;{#IFGUID}&quot;],15m)&lt;(({$IF.UTIL.MAX:&quot;{#IFNAME}&quot;}-3)/100)*last(/Rus Win Zb agent/net.if.speed[&quot;{#IFGUID}&quot;]) and
avg(/Rus Win Zb agent/net.if.out[&quot;{#IFGUID}&quot;],15m)&lt;(({$IF.UTIL.MAX:&quot;{#IFNAME}&quot;}-3)/100)*last(/Rus Win Zb agent/net.if.speed[&quot;{#IFGUID}&quot;])</recovery_expression>
                            <name>Interface {#IFNAME}({#IFALIAS}): High bandwidth usage (&gt;{$IF.UTIL.MAX:&quot;{#IFNAME}&quot;}%)</name>
                            <opdata>In: {ITEM.LASTVALUE1}, out: {ITEM.LASTVALUE3}, speed: {ITEM.LASTVALUE2}</opdata>
                            <priority>WARNING</priority>
                            <description>The network interface utilization is close to its estimated maximum bandwidth.</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Interface {#IFNAME}({#IFALIAS}): Link down</name>
                                    <expression>{$IFCONTROL:&quot;{#IFNAME}&quot;}=1 and last(/Rus Win Zb agent/net.if.status[&quot;{#IFGUID}&quot;])&lt;&gt;2 and (last(/Rus Win Zb agent/net.if.status[&quot;{#IFGUID}&quot;],#1)&lt;&gt;last(/Rus Win Zb agent/net.if.status[&quot;{#IFGUID}&quot;],#2))</expression>
                                    <recovery_expression>last(/Rus Win Zb agent/net.if.status[&quot;{#IFGUID}&quot;])=2 or {$IFCONTROL:&quot;{#IFNAME}&quot;}=0</recovery_expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>scope</tag>
                                    <value>performance</value>
                                </tag>
                            </tags>
                        </trigger_prototype>
                        <trigger_prototype>
                            <uuid>a4fa6e161bb64b98b25b1a2a501a83f4</uuid>
                            <expression>min(/Rus Win Zb agent/net.if.in[&quot;{#IFGUID}&quot;,errors],5m)&gt;{$IF.ERRORS.WARN:&quot;{#IFNAME}&quot;}
or min(/Rus Win Zb agent/net.if.out[&quot;{#IFGUID}&quot;,errors],5m)&gt;{$IF.ERRORS.WARN:&quot;{#IFNAME}&quot;}</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>max(/Rus Win Zb agent/net.if.in[&quot;{#IFGUID}&quot;,errors],5m)&lt;{$IF.ERRORS.WARN:&quot;{#IFNAME}&quot;}*0.8
and max(/Rus Win Zb agent/net.if.out[&quot;{#IFGUID}&quot;,errors],5m)&lt;{$IF.ERRORS.WARN:&quot;{#IFNAME}&quot;}*0.8</recovery_expression>
                            <name>Interface {#IFNAME}({#IFALIAS}): High error rate (&gt;{$IF.ERRORS.WARN:&quot;{#IFNAME}&quot;} for 5m)</name>
                            <opdata>errors in: {ITEM.LASTVALUE1}, errors out: {ITEM.LASTVALUE2}</opdata>
                            <priority>WARNING</priority>
                            <description>Recovers when below 80% of {$IF.ERRORS.WARN:&quot;{#IFNAME}&quot;} threshold</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Interface {#IFNAME}({#IFALIAS}): Link down</name>
                                    <expression>{$IFCONTROL:&quot;{#IFNAME}&quot;}=1 and last(/Rus Win Zb agent/net.if.status[&quot;{#IFGUID}&quot;])&lt;&gt;2 and (last(/Rus Win Zb agent/net.if.status[&quot;{#IFGUID}&quot;],#1)&lt;&gt;last(/Rus Win Zb agent/net.if.status[&quot;{#IFGUID}&quot;],#2))</expression>
                                    <recovery_expression>last(/Rus Win Zb agent/net.if.status[&quot;{#IFGUID}&quot;])=2 or {$IFCONTROL:&quot;{#IFNAME}&quot;}=0</recovery_expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>scope</tag>
                                    <value>availability</value>
                                </tag>
                            </tags>
                        </trigger_prototype>
                    </trigger_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <uuid>5cbfad75590746718cf4eabbeeea43f3</uuid>
                            <name>Interface {#IFNAME}({#IFALIAS}): Network traffic</name>
                            <graph_items>
                                <graph_item>
                                    <drawtype>GRADIENT_LINE</drawtype>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>Rus Win Zb agent</host>
                                        <key>net.if.in[&quot;{#IFGUID}&quot;]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <drawtype>BOLD_LINE</drawtype>
                                    <color>2774A4</color>
                                    <item>
                                        <host>Rus Win Zb agent</host>
                                        <key>net.if.out[&quot;{#IFGUID}&quot;]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <color>F63100</color>
                                    <yaxisside>RIGHT</yaxisside>
                                    <item>
                                        <host>Rus Win Zb agent</host>
                                        <key>net.if.out[&quot;{#IFGUID}&quot;,errors]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>3</sortorder>
                                    <color>A54F10</color>
                                    <yaxisside>RIGHT</yaxisside>
                                    <item>
                                        <host>Rus Win Zb agent</host>
                                        <key>net.if.in[&quot;{#IFGUID}&quot;,errors]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>4</sortorder>
                                    <color>FC6EA3</color>
                                    <yaxisside>RIGHT</yaxisside>
                                    <item>
                                        <host>Rus Win Zb agent</host>
                                        <key>net.if.out[&quot;{#IFGUID}&quot;,dropped]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>5</sortorder>
                                    <color>6C59DC</color>
                                    <yaxisside>RIGHT</yaxisside>
                                    <item>
                                        <host>Rus Win Zb agent</host>
                                        <key>net.if.in[&quot;{#IFGUID}&quot;,dropped]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                    <master_item>
                        <key>wmi.getall[root\cimv2,&quot;select Name,Description,NetConnectionID,Speed,AdapterTypeId,NetConnectionStatus,GUID from win32_networkadapter where PhysicalAdapter=True and NetConnectionStatus&gt;0&quot;]</key>
                    </master_item>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>output = JSON.parse(value).map(function(net){
    return {
        &quot;{#IFNAME}&quot;: net.Name,
        &quot;{#IFDESCR}&quot;: net.Description,
        &quot;{#IFALIAS}&quot;: net.NetConnectionID,
        &quot;{#IFGUID}&quot;: net.GUID
    }})
return JSON.stringify({&quot;data&quot;: output})</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>1h</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <uuid>8f155ebc6fd045b3b7548010af1a73c7</uuid>
                    <name>Physical disks discovery</name>
                    <key>perf_instance_en.discovery[PhysicalDisk]</key>
                    <delay>1h</delay>
                    <filter>
                        <evaltype>AND</evaltype>
                        <conditions>
                            <condition>
                                <macro>{#DEVNAME}</macro>
                                <value>{$VFS.DEV.DEVNAME.MATCHES}</value>
                                <formulaid>A</formulaid>
                            </condition>
                            <condition>
                                <macro>{#DEVNAME}</macro>
                                <value>{$VFS.DEV.DEVNAME.NOT_MATCHES}</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>B</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <description>Discovery of installed physical disks.</description>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>821f46bbf9d7432e9ea0d5f93a868269</uuid>
                            <name>{#DEVNAME}: Disk utilization by idle time</name>
                            <key>perf_counter_en[&quot;\PhysicalDisk({#DEVNAME})\% Idle Time&quot;,60]</key>
                            <history>7d</history>
                            <value_type>FLOAT</value_type>
                            <units>%</units>
                            <description>This item is the percentage of elapsed time that the selected disk drive was busy servicing read or writes requests based on idle time.</description>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>return (100 - value)</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>storage</value>
                                </tag>
                                <tag>
                                    <tag>disk</tag>
                                    <value>{#DEVNAME}</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>4777fa000fa9460baab1fd7bc7e40604</uuid>
                                    <expression>min(/Rus Win Zb agent/perf_counter_en[&quot;\PhysicalDisk({#DEVNAME})\% Idle Time&quot;,60],15m)&gt;{$VFS.DEV.UTIL.MAX.WARN}</expression>
                                    <name>{#DEVNAME}: Disk is overloaded (util &gt; {$VFS.DEV.UTIL.MAX.WARN}% for 15m)</name>
                                    <priority>WARNING</priority>
                                    <description>The disk appears to be under heavy load</description>
                                    <manual_close>YES</manual_close>
                                    <dependencies>
                                        <dependency>
                                            <name>{#DEVNAME}: Disk read request responses are too high (read &gt; {$VFS.DEV.READ.AWAIT.WARN:&quot;{#DEVNAME}&quot;}s for 15m</name>
                                            <expression>min(/Rus Win Zb agent/perf_counter_en[&quot;\PhysicalDisk({#DEVNAME})\Avg. Disk sec/Read&quot;,60],15m) &gt; {$VFS.DEV.READ.AWAIT.WARN:&quot;{#DEVNAME}&quot;}</expression>
                                        </dependency>
                                        <dependency>
                                            <name>{#DEVNAME}: Disk write request responses are too high (write &gt; {$VFS.DEV.WRITE.AWAIT.WARN:&quot;{#DEVNAME}&quot;}s for 15m)</name>
                                            <expression>min(/Rus Win Zb agent/perf_counter_en[&quot;\PhysicalDisk({#DEVNAME})\Avg. Disk sec/Write&quot;,60],15m) &gt; {$VFS.DEV.WRITE.AWAIT.WARN:&quot;{#DEVNAME}&quot;}</expression>
                                        </dependency>
                                    </dependencies>
                                    <tags>
                                        <tag>
                                            <tag>scope</tag>
                                            <value>performance</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>77e33448596a498ba211d23a1977e9ca</uuid>
                            <name>{#DEVNAME}: Average disk read queue length</name>
                            <key>perf_counter_en[&quot;\PhysicalDisk({#DEVNAME})\Avg. Disk Read Queue Length&quot;,60]</key>
                            <history>7d</history>
                            <value_type>FLOAT</value_type>
                            <description>Average disk read queue, the number of requests outstanding on the disk at the time the performance data is collected.</description>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>storage</value>
                                </tag>
                                <tag>
                                    <tag>disk</tag>
                                    <value>{#DEVNAME}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>7d91ed70bc3b4ef2a7991b3a5ba3bde4</uuid>
                            <name>{#DEVNAME}: Disk read request avg waiting time</name>
                            <key>perf_counter_en[&quot;\PhysicalDisk({#DEVNAME})\Avg. Disk sec/Read&quot;,60]</key>
                            <history>7d</history>
                            <value_type>FLOAT</value_type>
                            <units>s</units>
                            <description>The average time for read requests issued to the device to be served. This includes the time spent by the requests in queue and the time spent servicing them.</description>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>storage</value>
                                </tag>
                                <tag>
                                    <tag>disk</tag>
                                    <value>{#DEVNAME}</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>85a8c002b3d84121ad2e73c8aced0987</uuid>
                                    <expression>min(/Rus Win Zb agent/perf_counter_en[&quot;\PhysicalDisk({#DEVNAME})\Avg. Disk sec/Read&quot;,60],15m) &gt; {$VFS.DEV.READ.AWAIT.WARN:&quot;{#DEVNAME}&quot;}</expression>
                                    <name>{#DEVNAME}: Disk read request responses are too high (read &gt; {$VFS.DEV.READ.AWAIT.WARN:&quot;{#DEVNAME}&quot;}s for 15m</name>
                                    <priority>WARNING</priority>
                                    <description>This trigger might indicate disk {#DEVNAME} saturation.</description>
                                    <manual_close>YES</manual_close>
                                    <tags>
                                        <tag>
                                            <tag>scope</tag>
                                            <value>performance</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>898784d050664f8eaf197ebebc16077e</uuid>
                            <name>{#DEVNAME}: Disk write request avg waiting time</name>
                            <key>perf_counter_en[&quot;\PhysicalDisk({#DEVNAME})\Avg. Disk sec/Write&quot;,60]</key>
                            <history>7d</history>
                            <value_type>FLOAT</value_type>
                            <units>s</units>
                            <description>The average time for write requests issued to the device to be served. This includes the time spent by the requests in queue and the time spent servicing them.</description>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>storage</value>
                                </tag>
                                <tag>
                                    <tag>disk</tag>
                                    <value>{#DEVNAME}</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>db6809fd85e241948fb5ef76cb7cc17b</uuid>
                                    <expression>min(/Rus Win Zb agent/perf_counter_en[&quot;\PhysicalDisk({#DEVNAME})\Avg. Disk sec/Write&quot;,60],15m) &gt; {$VFS.DEV.WRITE.AWAIT.WARN:&quot;{#DEVNAME}&quot;}</expression>
                                    <name>{#DEVNAME}: Disk write request responses are too high (write &gt; {$VFS.DEV.WRITE.AWAIT.WARN:&quot;{#DEVNAME}&quot;}s for 15m)</name>
                                    <priority>WARNING</priority>
                                    <description>This trigger might indicate disk {#DEVNAME} saturation.</description>
                                    <manual_close>YES</manual_close>
                                    <tags>
                                        <tag>
                                            <tag>scope</tag>
                                            <value>performance</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>71a2c065efaa437fb7296972f516bd82</uuid>
                            <name>{#DEVNAME}: Average disk write queue length</name>
                            <key>perf_counter_en[&quot;\PhysicalDisk({#DEVNAME})\Avg. Disk Write Queue Length&quot;,60]</key>
                            <history>7d</history>
                            <value_type>FLOAT</value_type>
                            <description>Average disk write queue, the number of requests outstanding on the disk at the time the performance data is collected.</description>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>storage</value>
                                </tag>
                                <tag>
                                    <tag>disk</tag>
                                    <value>{#DEVNAME}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>b49884669dbf43cc95ea3d27fb23698c</uuid>
                            <name>{#DEVNAME}: Disk average queue size (avgqu-sz)</name>
                            <key>perf_counter_en[&quot;\PhysicalDisk({#DEVNAME})\Current Disk Queue Length&quot;,60]</key>
                            <history>7d</history>
                            <value_type>FLOAT</value_type>
                            <description>Current average disk queue, the number of requests outstanding on the disk at the time the performance data is collected.</description>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>storage</value>
                                </tag>
                                <tag>
                                    <tag>disk</tag>
                                    <value>{#DEVNAME}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>390c6e4f2c134ae2939810892eefd6f7</uuid>
                            <name>{#DEVNAME}: Disk read rate</name>
                            <key>perf_counter_en[&quot;\PhysicalDisk({#DEVNAME})\Disk Reads/sec&quot;,60]</key>
                            <history>7d</history>
                            <value_type>FLOAT</value_type>
                            <units>!r/s</units>
                            <description>Rate of read operations on the disk.</description>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>storage</value>
                                </tag>
                                <tag>
                                    <tag>disk</tag>
                                    <value>{#DEVNAME}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>6353d621a9c4415c94247208fc996075</uuid>
                            <name>{#DEVNAME}: Disk write rate</name>
                            <key>perf_counter_en[&quot;\PhysicalDisk({#DEVNAME})\Disk Writes/sec&quot;,60]</key>
                            <history>7d</history>
                            <value_type>FLOAT</value_type>
                            <units>!w/s</units>
                            <description>Rate of write operations on the disk.</description>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>storage</value>
                                </tag>
                                <tag>
                                    <tag>disk</tag>
                                    <value>{#DEVNAME}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <uuid>6d37f811023b4f65a071b1deb9b1b8ec</uuid>
                            <name>{#DEVNAME}: Disk average queue length</name>
                            <graph_items>
                                <graph_item>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>Rus Win Zb agent</host>
                                        <key>perf_counter_en[&quot;\PhysicalDisk({#DEVNAME})\Avg. Disk Read Queue Length&quot;,60]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>2774A4</color>
                                    <item>
                                        <host>Rus Win Zb agent</host>
                                        <key>perf_counter_en[&quot;\PhysicalDisk({#DEVNAME})\Avg. Disk Write Queue Length&quot;,60]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                        <graph_prototype>
                            <uuid>f54bdfb7e0c7471f80b8ca599bc4f904</uuid>
                            <name>{#DEVNAME}: Disk average waiting time</name>
                            <graph_items>
                                <graph_item>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>Rus Win Zb agent</host>
                                        <key>perf_counter_en[&quot;\PhysicalDisk({#DEVNAME})\Avg. Disk sec/Read&quot;,60]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <drawtype>GRADIENT_LINE</drawtype>
                                    <color>2774A4</color>
                                    <item>
                                        <host>Rus Win Zb agent</host>
                                        <key>perf_counter_en[&quot;\PhysicalDisk({#DEVNAME})\Avg. Disk sec/Write&quot;,60]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                        <graph_prototype>
                            <uuid>339a20ba0d3f4ba4a05aee0611124819</uuid>
                            <name>{#DEVNAME}: Disk read/write rates</name>
                            <graph_items>
                                <graph_item>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>Rus Win Zb agent</host>
                                        <key>perf_counter_en[&quot;\PhysicalDisk({#DEVNAME})\Disk Reads/sec&quot;,60]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <drawtype>GRADIENT_LINE</drawtype>
                                    <color>2774A4</color>
                                    <item>
                                        <host>Rus Win Zb agent</host>
                                        <key>perf_counter_en[&quot;\PhysicalDisk({#DEVNAME})\Disk Writes/sec&quot;,60]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                        <graph_prototype>
                            <uuid>bc71dc24634742028a5c8384dcaa0f32</uuid>
                            <name>{#DEVNAME}: Disk utilization and queue</name>
                            <graph_items>
                                <graph_item>
                                    <color>1A7C11</color>
                                    <yaxisside>RIGHT</yaxisside>
                                    <item>
                                        <host>Rus Win Zb agent</host>
                                        <key>perf_counter_en[&quot;\PhysicalDisk({#DEVNAME})\Current Disk Queue Length&quot;,60]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <drawtype>GRADIENT_LINE</drawtype>
                                    <color>2774A4</color>
                                    <item>
                                        <host>Rus Win Zb agent</host>
                                        <key>perf_counter_en[&quot;\PhysicalDisk({#DEVNAME})\% Idle Time&quot;,60]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                    <preprocessing>
                        <step>
                            <type>STR_REPLACE</type>
                            <parameters>
                                <parameter>{#INSTANCE}</parameter>
                                <parameter>{#DEVNAME}</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <uuid>cabcad5c3520448f8e1bf222be348b81</uuid>
                    <name>Windows services discovery</name>
                    <key>service.discovery</key>
                    <delay>1h</delay>
                    <filter>
                        <evaltype>AND</evaltype>
                        <conditions>
                            <condition>
                                <macro>{#SERVICE.NAME}</macro>
                                <value>{$SERVICE.NAME.MATCHES}</value>
                                <formulaid>A</formulaid>
                            </condition>
                            <condition>
                                <macro>{#SERVICE.NAME}</macro>
                                <value>{$SERVICE.NAME.NOT_MATCHES}</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>B</formulaid>
                            </condition>
                            <condition>
                                <macro>{#SERVICE.STARTUPNAME}</macro>
                                <value>{$SERVICE.STARTUPNAME.MATCHES}</value>
                                <formulaid>C</formulaid>
                            </condition>
                            <condition>
                                <macro>{#SERVICE.STARTUPNAME}</macro>
                                <value>{$SERVICE.STARTUPNAME.NOT_MATCHES}</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>D</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <description>Discovery of Windows services of different types as defined in template's macros.</description>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>dd5a027d75fc4ff1a3bb6e69c0d8d592</uuid>
                            <name>State of service &quot;{#SERVICE.NAME}&quot; ({#SERVICE.DISPLAYNAME})</name>
                            <key>service.info[&quot;{#SERVICE.NAME}&quot;,state]</key>
                            <history>7d</history>
                            <valuemap>
                                <name>Windows service state</name>
                            </valuemap>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>system</value>
                                </tag>
                                <tag>
                                    <tag>name</tag>
                                    <value>{#SERVICE.DISPLAYNAME}</value>
                                </tag>
                                <tag>
                                    <tag>service</tag>
                                    <value>{#SERVICE.NAME}</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>4708592603db4577b26cb6daade41754</uuid>
                                    <expression>min(/Rus Win Zb agent/service.info[&quot;{#SERVICE.NAME}&quot;,state],#3)&lt;&gt;0</expression>
                                    <name>&quot;{#SERVICE.NAME}&quot; ({#SERVICE.DISPLAYNAME}) is not running (startup type {#SERVICE.STARTUPNAME})</name>
                                    <status>DISABLED</status>
                                    <discover>NO_DISCOVER</discover>
                                    <priority>AVERAGE</priority>
                                    <description>The service has a state other than &quot;Running&quot; for the last three times.</description>
                                    <tags>
                                        <tag>
                                            <tag>scope</tag>
                                            <value>notice</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <uuid>c22b79b52f9148728095bda2796a753e</uuid>
                    <name>Mounted filesystem discovery</name>
                    <key>vfs.fs.discovery</key>
                    <delay>1h</delay>
                    <filter>
                        <evaltype>AND</evaltype>
                        <conditions>
                            <condition>
                                <macro>{#FSTYPE}</macro>
                                <value>{$VFS.FS.FSTYPE.MATCHES}</value>
                                <formulaid>E</formulaid>
                            </condition>
                            <condition>
                                <macro>{#FSTYPE}</macro>
                                <value>{$VFS.FS.FSTYPE.NOT_MATCHES}</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>F</formulaid>
                            </condition>
                            <condition>
                                <macro>{#FSNAME}</macro>
                                <value>{$VFS.FS.FSNAME.MATCHES}</value>
                                <formulaid>C</formulaid>
                            </condition>
                            <condition>
                                <macro>{#FSNAME}</macro>
                                <value>{$VFS.FS.FSNAME.NOT_MATCHES}</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>D</formulaid>
                            </condition>
                            <condition>
                                <macro>{#FSDRIVETYPE}</macro>
                                <value>{$VFS.FS.FSDRIVETYPE.MATCHES}</value>
                                <formulaid>A</formulaid>
                            </condition>
                            <condition>
                                <macro>{#FSDRIVETYPE}</macro>
                                <value>{$VFS.FS.FSDRIVETYPE.NOT_MATCHES}</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>B</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <description>Discovery of file systems of different types.</description>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>7bf3bd42cdf444389e6953090900c620</uuid>
                            <name>{#FSLABEL}({#FSNAME}): Space utilization</name>
                            <key>vfs.fs.size[{#FSNAME},pused]</key>
                            <history>7d</history>
                            <value_type>FLOAT</value_type>
                            <units>%</units>
                            <description>Space utilization in % for {#FSNAME}</description>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>storage</value>
                                </tag>
                                <tag>
                                    <tag>filesystem</tag>
                                    <value>{#FSNAME}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>69378521b7e844ec89afe753a7cba30e</uuid>
                            <name>{#FSLABEL}({#FSNAME}): Total space</name>
                            <key>vfs.fs.size[{#FSNAME},total]</key>
                            <history>7d</history>
                            <units>B</units>
                            <description>Total space in Bytes</description>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>storage</value>
                                </tag>
                                <tag>
                                    <tag>filesystem</tag>
                                    <value>{#FSNAME}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>a29509b4b7f24c25a768e88e0c23c154</uuid>
                            <name>{#FSLABEL}({#FSNAME}): Used space</name>
                            <key>vfs.fs.size[{#FSNAME},used]</key>
                            <history>7d</history>
                            <units>B</units>
                            <description>Used storage in Bytes</description>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>storage</value>
                                </tag>
                                <tag>
                                    <tag>filesystem</tag>
                                    <value>{#FSNAME}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <uuid>d3e99134a1d04894918f2c92ff38cb92</uuid>
                            <expression>last(/Rus Win Zb agent/vfs.fs.size[{#FSNAME},pused])&gt;{$VFS.FS.PUSED.MAX.CRIT:&quot;{#FSNAME}&quot;} and
((last(/Rus Win Zb agent/vfs.fs.size[{#FSNAME},total])-last(/Rus Win Zb agent/vfs.fs.size[{#FSNAME},used]))&lt;5G or timeleft(/Rus Win Zb agent/vfs.fs.size[{#FSNAME},pused],1h,100)&lt;1d)</expression>
                            <name>{#FSLABEL}({#FSNAME}): Disk space is critically low (used &gt; {$VFS.FS.PUSED.MAX.CRIT:&quot;{#FSNAME}&quot;}%)</name>
                            <opdata>Space used: {ITEM.LASTVALUE3} of {ITEM.LASTVALUE2} ({ITEM.LASTVALUE1})</opdata>
                            <priority>AVERAGE</priority>
                            <description>Two conditions should match: First, space utilization should be above {$VFS.FS.PUSED.MAX.CRIT:&quot;{#FSNAME}&quot;}.
 Second condition should be one of the following:
 - The disk free space is less than 5G.
 - The disk will be full in less than 24 hours.</description>
                            <manual_close>YES</manual_close>
                            <tags>
                                <tag>
                                    <tag>scope</tag>
                                    <value>capacity</value>
                                </tag>
                            </tags>
                        </trigger_prototype>
                        <trigger_prototype>
                            <uuid>97115bbe4f6b4a8cb2873b8fa01f95d3</uuid>
                            <expression>last(/Rus Win Zb agent/vfs.fs.size[{#FSNAME},pused])&gt;{$VFS.FS.PUSED.MAX.WARN:&quot;{#FSNAME}&quot;} and
((last(/Rus Win Zb agent/vfs.fs.size[{#FSNAME},total])-last(/Rus Win Zb agent/vfs.fs.size[{#FSNAME},used]))&lt;10G or timeleft(/Rus Win Zb agent/vfs.fs.size[{#FSNAME},pused],1h,100)&lt;1d)</expression>
                            <name>{#FSLABEL}({#FSNAME}): Disk space is low (used &gt; {$VFS.FS.PUSED.MAX.WARN:&quot;{#FSNAME}&quot;}%)</name>
                            <opdata>Space used: {ITEM.LASTVALUE3} of {ITEM.LASTVALUE2} ({ITEM.LASTVALUE1})</opdata>
                            <priority>WARNING</priority>
                            <description>Two conditions should match: First, space utilization should be above {$VFS.FS.PUSED.MAX.WARN:&quot;{#FSNAME}&quot;}.
 Second condition should be one of the following:
 - The disk free space is less than 10G.
 - The disk will be full in less than 24 hours.</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>{#FSLABEL}({#FSNAME}): Disk space is critically low (used &gt; {$VFS.FS.PUSED.MAX.CRIT:&quot;{#FSNAME}&quot;}%)</name>
                                    <expression>last(/Rus Win Zb agent/vfs.fs.size[{#FSNAME},pused])&gt;{$VFS.FS.PUSED.MAX.CRIT:&quot;{#FSNAME}&quot;} and
((last(/Rus Win Zb agent/vfs.fs.size[{#FSNAME},total])-last(/Rus Win Zb agent/vfs.fs.size[{#FSNAME},used]))&lt;5G or timeleft(/Rus Win Zb agent/vfs.fs.size[{#FSNAME},pused],1h,100)&lt;1d)</expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>scope</tag>
                                    <value>capacity</value>
                                </tag>
                            </tags>
                        </trigger_prototype>
                    </trigger_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <uuid>f80e47b8d4db4c378f25056c02b72382</uuid>
                            <name>{#FSLABEL}({#FSNAME}): Disk space usage</name>
                            <width>600</width>
                            <height>340</height>
                            <type>PIE</type>
                            <show_3d>YES</show_3d>
                            <graph_items>
                                <graph_item>
                                    <color>969696</color>
                                    <calc_fnc>LAST</calc_fnc>
                                    <type>GRAPH_SUM</type>
                                    <item>
                                        <host>Rus Win Zb agent</host>
                                        <key>vfs.fs.size[{#FSNAME},total]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>C80000</color>
                                    <calc_fnc>LAST</calc_fnc>
                                    <item>
                                        <host>Rus Win Zb agent</host>
                                        <key>vfs.fs.size[{#FSNAME},used]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
            </discovery_rules>
            <tags>
                <tag>
                    <tag>class</tag>
                    <value>os</value>
                </tag>
                <tag>
                    <tag>target</tag>
                    <value>windows</value>
                </tag>
            </tags>
            <macros>
                <macro>
                    <macro>{$AGENT.TIMEOUT}</macro>
                    <value>3m</value>
                    <description>Timeout after which agent is considered unavailable. Works only for agents reachable from Zabbix server/proxy (passive mode).</description>
                </macro>
                <macro>
                    <macro>{$CPU.INTERRUPT.CRIT.MAX}</macro>
                    <value>50</value>
                    <description>The critical threshold of the % Interrupt Time counter.</description>
                </macro>
                <macro>
                    <macro>{$CPU.PRIV.CRIT.MAX}</macro>
                    <value>30</value>
                    <description>The threshold of the % Privileged Time counter.</description>
                </macro>
                <macro>
                    <macro>{$CPU.QUEUE.CRIT.MAX}</macro>
                    <value>3</value>
                    <description>The threshold of the Processor Queue Length counter.</description>
                </macro>
                <macro>
                    <macro>{$CPU.UTIL.CRIT}</macro>
                    <value>90</value>
                    <description>The critical threshold of the CPU utilization in %.</description>
                </macro>
                <macro>
                    <macro>{$IF.ERRORS.WARN}</macro>
                    <value>2</value>
                </macro>
                <macro>
                    <macro>{$IF.UTIL.MAX}</macro>
                    <value>90</value>
                </macro>
                <macro>
                    <macro>{$IFCONTROL}</macro>
                    <value>1</value>
                </macro>
                <macro>
                    <macro>{$MEM.PAGE_SEC.CRIT.MAX}</macro>
                    <value>1000</value>
                    <description>The warning threshold of the Memory Pages/sec counter.</description>
                </macro>
                <macro>
                    <macro>{$MEM.PAGE_TABLE_CRIT.MIN}</macro>
                    <value>5000</value>
                    <description>The warning threshold of the Free System Page Table Entries counter.</description>
                </macro>
                <macro>
                    <macro>{$MEMORY.UTIL.MAX}</macro>
                    <value>90</value>
                    <description>The warning threshold of the Memory util item.</description>
                </macro>
                <macro>
                    <macro>{$NET.IF.IFALIAS.MATCHES}</macro>
                    <value>.*</value>
                    <description>This macro is used in Network interface discovery. Can be overridden on the host or linked template level.</description>
                </macro>
                <macro>
                    <macro>{$NET.IF.IFALIAS.NOT_MATCHES}</macro>
                    <value>CHANGE_THIS</value>
                    <description>This macro is used in Network interface discovery. Can be overridden on the host or linked template level.</description>
                </macro>
                <macro>
                    <macro>{$NET.IF.IFDESCR.MATCHES}</macro>
                    <value>.*</value>
                    <description>This macro is used in Network interface discovery. Can be overridden on the host or linked template level.</description>
                </macro>
                <macro>
                    <macro>{$NET.IF.IFDESCR.NOT_MATCHES}</macro>
                    <value>CHANGE_THIS</value>
                    <description>This macro is used in Network interface discovery. Can be overridden on the host or linked template level.</description>
                </macro>
                <macro>
                    <macro>{$NET.IF.IFNAME.MATCHES}</macro>
                    <value>.*</value>
                    <description>This macro is used in Network interface discovery. Can be overridden on the host or linked template level.</description>
                </macro>
                <macro>
                    <macro>{$NET.IF.IFNAME.NOT_MATCHES}</macro>
                    <value>Miniport|Virtual|Teredo|Kernel|Loopback|Bluetooth|HTTPS|6to4|QoS|Layer</value>
                    <description>This macro is used in Network interface discovery. Can be overridden on the host or linked template level.</description>
                </macro>
                <macro>
                    <macro>{$SERVICE.NAME.MATCHES}</macro>
                    <value>^.*$</value>
                    <description>This macro is used in Service discovery. Can be overridden on the host or linked template level.</description>
                </macro>
                <macro>
                    <macro>{$SERVICE.NAME.NOT_MATCHES}</macro>
                    <value>^(?:RemoteRegistry|MMCSS|gupdate|SysmonLog|clr_optimization_v.+|clr_optimization_v.+|sppsvc|gpsvc|Pml Driver HPZ12|Net Driver HPZ12|MapsBroker|IntelAudioService|Intel\(R\) TPM Provisioning Service|dbupdate|DoSvc)$</value>
                    <description>This macro is used in Service discovery. Can be overridden on the host or linked template level.</description>
                </macro>
                <macro>
                    <macro>{$SERVICE.STARTUPNAME.MATCHES}</macro>
                    <value>^(?:automatic|automatic delayed)$</value>
                    <description>This macro is used in Service discovery. Can be overridden on the host or linked template level.</description>
                </macro>
                <macro>
                    <macro>{$SERVICE.STARTUPNAME.NOT_MATCHES}</macro>
                    <value>^(?:manual|disabled)$</value>
                    <description>This macro is used in Service discovery. Can be overridden on the host or linked template level.</description>
                </macro>
                <macro>
                    <macro>{$SWAP.PFREE.MIN.WARN}</macro>
                    <value>20</value>
                    <description>The warning threshold of the minimum free swap.</description>
                </macro>
                <macro>
                    <macro>{$SYSTEM.FUZZYTIME.MAX}</macro>
                    <value>60</value>
                    <description>The threshold for difference of system time in seconds.</description>
                </macro>
                <macro>
                    <macro>{$VFS.DEV.DEVNAME.MATCHES}</macro>
                    <value>.*</value>
                    <description>This macro is used in physical disks discovery. Can be overridden on the host or linked template level.</description>
                </macro>
                <macro>
                    <macro>{$VFS.DEV.DEVNAME.NOT_MATCHES}</macro>
                    <value>_Total</value>
                    <description>This macro is used in physical disks discovery. Can be overridden on the host or linked template level.</description>
                </macro>
                <macro>
                    <macro>{$VFS.DEV.READ.AWAIT.WARN}</macro>
                    <value>0.02</value>
                    <description>Disk read average response time (in s) before the trigger would fire.</description>
                </macro>
                <macro>
                    <macro>{$VFS.DEV.UTIL.MAX.WARN}</macro>
                    <value>95</value>
                    <description>The warning threshold of disk time utilization in percent.</description>
                </macro>
                <macro>
                    <macro>{$VFS.DEV.WRITE.AWAIT.WARN}</macro>
                    <value>0.02</value>
                    <description>Disk write average response time (in s) before the trigger would fire.</description>
                </macro>
                <macro>
                    <macro>{$VFS.FS.FSDRIVETYPE.MATCHES}</macro>
                    <value>fixed</value>
                    <description>This macro is used in filesystems discovery. Can be overridden on the host or linked template level.</description>
                </macro>
                <macro>
                    <macro>{$VFS.FS.FSDRIVETYPE.NOT_MATCHES}</macro>
                    <value>^\s$</value>
                    <description>This macro is used in filesystems discovery. Can be overridden on the host or linked template level.</description>
                </macro>
                <macro>
                    <macro>{$VFS.FS.FSNAME.MATCHES}</macro>
                    <value>.*</value>
                    <description>This macro is used in filesystems discovery. Can be overridden on the host or linked template level.</description>
                </macro>
                <macro>
                    <macro>{$VFS.FS.FSNAME.NOT_MATCHES}</macro>
                    <value>^(?:/dev|/sys|/run|/proc|.+/shm$)</value>
                    <description>This macro is used in filesystems discovery. Can be overridden on the host or linked template level.</description>
                </macro>
                <macro>
                    <macro>{$VFS.FS.FSTYPE.MATCHES}</macro>
                    <value>.*</value>
                    <description>This macro is used in filesystems discovery. Can be overridden on the host or linked template level.</description>
                </macro>
                <macro>
                    <macro>{$VFS.FS.FSTYPE.NOT_MATCHES}</macro>
                    <value>^\s$</value>
                    <description>This macro is used in filesystems discovery. Can be overridden on the host or linked template level.</description>
                </macro>
                <macro>
                    <macro>{$VFS.FS.PUSED.MAX.CRIT}</macro>
                    <value>90</value>
                    <description>The critical threshold of the filesystem utilization in percent.</description>
                </macro>
                <macro>
                    <macro>{$VFS.FS.PUSED.MAX.WARN}</macro>
                    <value>80</value>
                    <description>The warning threshold of the filesystem utilization in percent.</description>
                </macro>
            </macros>
            <dashboards>
                <dashboard>
                    <uuid>49212562a208434d9766aa82240230fd</uuid>
                    <name>Network interfaces</name>
                    <pages>
                        <page>
                            <widgets>
                                <widget>
                                    <type>GRAPH_PROTOTYPE</type>
                                    <width>24</width>
                                    <height>5</height>
                                    <fields>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>source_type</name>
                                            <value>2</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>columns</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>rows</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>GRAPH_PROTOTYPE</type>
                                            <name>graphid</name>
                                            <value>
                                                <name>Interface {#IFNAME}({#IFALIAS}): Network traffic</name>
                                                <host>Rus Win Zb agent</host>
                                            </value>
                                        </field>
                                    </fields>
                                </widget>
                            </widgets>
                        </page>
                    </pages>
                </dashboard>
                <dashboard>
                    <uuid>5f494fac9dc94bf3827b67ea212240f2</uuid>
                    <name>System performance</name>
                    <pages>
                        <page>
                            <widgets>
                                <widget>
                                    <type>GRAPH_CLASSIC</type>
                                    <width>12</width>
                                    <height>5</height>
                                    <fields>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>source_type</name>
                                            <value>0</value>
                                        </field>
                                        <field>
                                            <type>GRAPH</type>
                                            <name>graphid</name>
                                            <value>
                                                <name>CPU usage</name>
                                                <host>Rus Win Zb agent</host>
                                            </value>
                                        </field>
                                    </fields>
                                </widget>
                                <widget>
                                    <type>GRAPH_CLASSIC</type>
                                    <x>12</x>
                                    <width>12</width>
                                    <height>5</height>
                                    <fields>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>source_type</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>ITEM</type>
                                            <name>itemid</name>
                                            <value>
                                                <key>perf_counter_en[&quot;\System\Processor Queue Length&quot;]</key>
                                                <host>Rus Win Zb agent</host>
                                            </value>
                                        </field>
                                    </fields>
                                </widget>
                                <widget>
                                    <type>GRAPH_CLASSIC</type>
                                    <y>5</y>
                                    <width>12</width>
                                    <height>5</height>
                                    <fields>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>source_type</name>
                                            <value>0</value>
                                        </field>
                                        <field>
                                            <type>GRAPH</type>
                                            <name>graphid</name>
                                            <value>
                                                <name>Memory utilization</name>
                                                <host>Rus Win Zb agent</host>
                                            </value>
                                        </field>
                                    </fields>
                                </widget>
                                <widget>
                                    <type>GRAPH_CLASSIC</type>
                                    <x>12</x>
                                    <y>5</y>
                                    <width>12</width>
                                    <height>5</height>
                                    <fields>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>source_type</name>
                                            <value>0</value>
                                        </field>
                                        <field>
                                            <type>GRAPH</type>
                                            <name>graphid</name>
                                            <value>
                                                <name>Swap usage</name>
                                                <host>Rus Win Zb agent</host>
                                            </value>
                                        </field>
                                    </fields>
                                </widget>
                                <widget>
                                    <type>GRAPH_PROTOTYPE</type>
                                    <y>10</y>
                                    <width>24</width>
                                    <height>5</height>
                                    <fields>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>source_type</name>
                                            <value>2</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>columns</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>rows</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>GRAPH_PROTOTYPE</type>
                                            <name>graphid</name>
                                            <value>
                                                <name>{#FSLABEL}({#FSNAME}): Disk space usage</name>
                                                <host>Rus Win Zb agent</host>
                                            </value>
                                        </field>
                                    </fields>
                                </widget>
                                <widget>
                                    <type>GRAPH_PROTOTYPE</type>
                                    <y>15</y>
                                    <width>24</width>
                                    <height>5</height>
                                    <fields>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>source_type</name>
                                            <value>2</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>columns</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>rows</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>GRAPH_PROTOTYPE</type>
                                            <name>graphid</name>
                                            <value>
                                                <name>{#DEVNAME}: Disk read/write rates</name>
                                                <host>Rus Win Zb agent</host>
                                            </value>
                                        </field>
                                    </fields>
                                </widget>
                                <widget>
                                    <type>GRAPH_PROTOTYPE</type>
                                    <y>20</y>
                                    <width>24</width>
                                    <height>5</height>
                                    <fields>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>source_type</name>
                                            <value>2</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>columns</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>rows</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>GRAPH_PROTOTYPE</type>
                                            <name>graphid</name>
                                            <value>
                                                <name>{#DEVNAME}: Disk utilization and queue</name>
                                                <host>Rus Win Zb agent</host>
                                            </value>
                                        </field>
                                    </fields>
                                </widget>
                                <widget>
                                    <type>GRAPH_PROTOTYPE</type>
                                    <y>25</y>
                                    <width>24</width>
                                    <height>5</height>
                                    <fields>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>source_type</name>
                                            <value>2</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>columns</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>rows</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>GRAPH_PROTOTYPE</type>
                                            <name>graphid</name>
                                            <value>
                                                <name>Interface {#IFNAME}({#IFALIAS}): Network traffic</name>
                                                <host>Rus Win Zb agent</host>
                                            </value>
                                        </field>
                                    </fields>
                                </widget>
                            </widgets>
                        </page>
                    </pages>
                </dashboard>
            </dashboards>
            <valuemaps>
                <valuemap>
                    <uuid>9b087b9bfa09434ea0d0b5c32577abcc</uuid>
                    <name>Win32_NetworkAdapter::AdapterTypeId</name>
                    <mappings>
                        <mapping>
                            <value>0</value>
                            <newvalue>Ethernet 802.3</newvalue>
                        </mapping>
                        <mapping>
                            <value>1</value>
                            <newvalue>Token Ring 802.5</newvalue>
                        </mapping>
                        <mapping>
                            <value>2</value>
                            <newvalue>Fiber Distributed Data Interface (FDDI)</newvalue>
                        </mapping>
                        <mapping>
                            <value>3</value>
                            <newvalue>Wide Area Network (WAN)</newvalue>
                        </mapping>
                        <mapping>
                            <value>4</value>
                            <newvalue>LocalTalk</newvalue>
                        </mapping>
                        <mapping>
                            <value>5</value>
                            <newvalue>Ethernet using DIX header format</newvalue>
                        </mapping>
                        <mapping>
                            <value>6</value>
                            <newvalue>ARCNET</newvalue>
                        </mapping>
                        <mapping>
                            <value>7</value>
                            <newvalue>ARCNET (878.2)</newvalue>
                        </mapping>
                        <mapping>
                            <value>8</value>
                            <newvalue>ATM</newvalue>
                        </mapping>
                        <mapping>
                            <value>9</value>
                            <newvalue>Wireless</newvalue>
                        </mapping>
                        <mapping>
                            <value>10</value>
                            <newvalue>Infrared Wireless</newvalue>
                        </mapping>
                        <mapping>
                            <value>11</value>
                            <newvalue>Bpc</newvalue>
                        </mapping>
                        <mapping>
                            <value>12</value>
                            <newvalue>CoWan</newvalue>
                        </mapping>
                        <mapping>
                            <value>13</value>
                            <newvalue>1394</newvalue>
                        </mapping>
                    </mappings>
                </valuemap>
                <valuemap>
                    <uuid>7e549195e83446228db8bf1101bea83d</uuid>
                    <name>Win32_NetworkAdapter::NetConnectionStatus</name>
                    <mappings>
                        <mapping>
                            <value>0</value>
                            <newvalue>Disconnected</newvalue>
                        </mapping>
                        <mapping>
                            <value>1</value>
                            <newvalue>Connecting</newvalue>
                        </mapping>
                        <mapping>
                            <value>2</value>
                            <newvalue>Connected</newvalue>
                        </mapping>
                        <mapping>
                            <value>3</value>
                            <newvalue>Disconnecting</newvalue>
                        </mapping>
                        <mapping>
                            <value>4</value>
                            <newvalue>Hardware Not Present</newvalue>
                        </mapping>
                        <mapping>
                            <value>5</value>
                            <newvalue>Hardware Disabled</newvalue>
                        </mapping>
                        <mapping>
                            <value>6</value>
                            <newvalue>Hardware Malfunction</newvalue>
                        </mapping>
                        <mapping>
                            <value>7</value>
                            <newvalue>Media Disconnected</newvalue>
                        </mapping>
                        <mapping>
                            <value>8</value>
                            <newvalue>Authenticating</newvalue>
                        </mapping>
                        <mapping>
                            <value>9</value>
                            <newvalue>Authentication Succeeded</newvalue>
                        </mapping>
                        <mapping>
                            <value>10</value>
                            <newvalue>Authentication Failed</newvalue>
                        </mapping>
                        <mapping>
                            <value>11</value>
                            <newvalue>Invalid Address</newvalue>
                        </mapping>
                        <mapping>
                            <value>12</value>
                            <newvalue>Credentials Required</newvalue>
                        </mapping>
                    </mappings>
                </valuemap>
                <valuemap>
                    <uuid>3f685167f97c492598ad445fc938560f</uuid>
                    <name>Windows service state</name>
                    <mappings>
                        <mapping>
                            <value>0</value>
                            <newvalue>Running</newvalue>
                        </mapping>
                        <mapping>
                            <value>1</value>
                            <newvalue>Paused</newvalue>
                        </mapping>
                        <mapping>
                            <value>2</value>
                            <newvalue>Start pending</newvalue>
                        </mapping>
                        <mapping>
                            <value>3</value>
                            <newvalue>Pause pending</newvalue>
                        </mapping>
                        <mapping>
                            <value>4</value>
                            <newvalue>Continue pending</newvalue>
                        </mapping>
                        <mapping>
                            <value>5</value>
                            <newvalue>Stop pending</newvalue>
                        </mapping>
                        <mapping>
                            <value>6</value>
                            <newvalue>Stopped</newvalue>
                        </mapping>
                        <mapping>
                            <value>7</value>
                            <newvalue>Unknown</newvalue>
                        </mapping>
                        <mapping>
                            <value>255</value>
                            <newvalue>No such service</newvalue>
                        </mapping>
                    </mappings>
                </valuemap>
                <valuemap>
                    <uuid>c80233756c9d43769f334d632da07b8c</uuid>
                    <name>zabbix.host.available</name>
                    <mappings>
                        <mapping>
                            <value>0</value>
                            <newvalue>not available</newvalue>
                        </mapping>
                        <mapping>
                            <value>1</value>
                            <newvalue>available</newvalue>
                        </mapping>
                        <mapping>
                            <value>2</value>
                            <newvalue>unknown</newvalue>
                        </mapping>
                    </mappings>
                </valuemap>
                <valuemap>
                    <uuid>5d3e53f3090448c7aaf081eb32b28ced</uuid>
                    <name>Zabbix agent ping status</name>
                    <mappings>
                        <mapping>
                            <value>1</value>
                            <newvalue>Up</newvalue>
                        </mapping>
                    </mappings>
                </valuemap>
            </valuemaps>
        </template>
    </templates>
    <triggers>
        <trigger>
            <uuid>7c23e03060ce42b094aac2f8aea1a9ad</uuid>
            <expression>min(/Rus Win Zb agent/system.swap.pfree,5m)&lt;{$SWAP.PFREE.MIN.WARN} and last(/Rus Win Zb agent/system.swap.size[,total])&gt;0</expression>
            <name>Высокое использование пространства подкачки (less than {$SWAP.PFREE.MIN.WARN}% free)</name>
            <opdata>Free: {ITEM.LASTVALUE1}, total: {ITEM.LASTVALUE2}</opdata>
            <priority>WARNING</priority>
            <description>This trigger is ignored, if there is no swap configured</description>
            <dependencies>
                <dependency>
                    <name>Высокая загрузка памяти (&gt;{$MEMORY.UTIL.MAX}% в течении 5m)</name>
                    <expression>min(/Rus Win Zb agent/vm.memory.util,5m)&gt;{$MEMORY.UTIL.MAX}</expression>
                </dependency>
            </dependencies>
            <tags>
                <tag>
                    <tag>scope</tag>
                    <value>performance</value>
                </tag>
            </tags>
        </trigger>
        <trigger>
            <uuid>8b1baeb26e154f99aefeaba3ea4fa63b</uuid>
            <expression>min(/Rus Win Zb agent/perf_counter_en[&quot;\System\Processor Queue Length&quot;],5m) - last(/Rus Win Zb agent/wmi.get[root/cimv2,&quot;Select NumberOfLogicalProcessors from Win32_ComputerSystem&quot;]) * 2 &gt; {$CPU.QUEUE.CRIT.MAX}</expression>
            <name>Длина очереди ЦП слишком велика (over {$CPU.QUEUE.CRIT.MAX} в течении 5m)</name>
            <priority>WARNING</priority>
            <description>The CPU Queue Length in the last 5 minutes exceeds {$CPU.QUEUE.CRIT.MAX}. According to actual observations, PQL should not exceed the number of cores * 2. To fine-tune the conditions, use the macro {$CPU.QUEUE.CRIT.MAX }.</description>
            <dependencies>
                <dependency>
                    <name>Высокая загрузка ЦП (over {$CPU.UTIL.CRIT}% в течение 5m)</name>
                    <expression>min(/Rus Win Zb agent/system.cpu.util,5m)&gt;{$CPU.UTIL.CRIT}</expression>
                </dependency>
            </dependencies>
            <tags>
                <tag>
                    <tag>scope</tag>
                    <value>performance</value>
                </tag>
            </tags>
        </trigger>
    </triggers>
    <graphs>
        <graph>
            <uuid>02ec085b49614b30a45287a7e88a8da1</uuid>
            <name>CPU jumps</name>
            <graph_items>
                <graph_item>
                    <color>1A7C11</color>
                    <item>
                        <host>Rus Win Zb agent</host>
                        <key>perf_counter_en[&quot;\System\Context Switches/sec&quot;]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>2774A4</color>
                    <item>
                        <host>Rus Win Zb agent</host>
                        <key>perf_counter_en[&quot;\Processor Information(_total)\% Interrupt Time&quot;]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>0c2db401fe574282ab0beb6955049330</uuid>
            <name>CPU usage</name>
            <type>STACKED</type>
            <ymin_type_1>FIXED</ymin_type_1>
            <ymax_type_1>FIXED</ymax_type_1>
            <graph_items>
                <graph_item>
                    <color>1A7C11</color>
                    <item>
                        <host>Rus Win Zb agent</host>
                        <key>perf_counter_en[&quot;\Processor Information(_total)\% User Time&quot;]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>2774A4</color>
                    <item>
                        <host>Rus Win Zb agent</host>
                        <key>perf_counter_en[&quot;\Processor Information(_total)\% Privileged Time&quot;]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>5de711b16f3845659289483f6deb4761</uuid>
            <name>CPU utilization</name>
            <ymin_type_1>FIXED</ymin_type_1>
            <ymax_type_1>FIXED</ymax_type_1>
            <graph_items>
                <graph_item>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>1A7C11</color>
                    <item>
                        <host>Rus Win Zb agent</host>
                        <key>system.cpu.util</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>1b86c8f6fe3343e6838c5d02f4f64b2b</uuid>
            <name>Memory utilization</name>
            <ymin_type_1>FIXED</ymin_type_1>
            <ymax_type_1>FIXED</ymax_type_1>
            <graph_items>
                <graph_item>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>1A7C11</color>
                    <item>
                        <host>Rus Win Zb agent</host>
                        <key>vm.memory.util</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>518f6bcdcefc4cf493244798ccd09ec1</uuid>
            <name>Swap usage</name>
            <graph_items>
                <graph_item>
                    <color>1A7C11</color>
                    <item>
                        <host>Rus Win Zb agent</host>
                        <key>system.swap.free</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>2774A4</color>
                    <item>
                        <host>Rus Win Zb agent</host>
                        <key>system.swap.size[,total]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
    </graphs>
</zabbix_export>
